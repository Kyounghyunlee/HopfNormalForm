module Systems

using SymEngine
using ..HopfNormalForm: calculate_normal_form
const I=1im
const i=1im

function example1()
    norder = 3; # Choose the order of power series representation of Centermanifold
    cm = 3; # Dimension of Centermanifold of the dynamical system
    m1 = 1; # Number of the zero eigenvalue corresponding to the center space of the Jacobian
    m2 = 1; # Number of pair of complex conjugate eigenvalue corresponding to the center space of the Jacobian
    m3 = 4; # Dimension of the stable manifold of the dynmical system
    n = m1+2*m2+m3; # Total dimension of the dynamical system
    ω_h = 15.4793; # Eigenvalue that crosses unit circle at Hopf bifurcation point ± ω_h
    zero_tol = 1e-13; # zero tolerance to chop out very small coeffs of symbolic computation

    v = [symbols("v_$i") for i in 1:n]; # Define state-space variables
    f = Array{Basic}(undef, n);

    @vars ka2, ka3, ν  # Define symbolic variables which is needed to define the equation of motion
    # In this example the variables are nonlinear stifness parameters

    # Define the equation of motion at the Hopf bifurcation point where the dimension of centermanifold is 2
    # Let the dimension of control parameter vector be 1, and express it as a one of state-space variable v[1]
    # d/dt v[1]=0 and let rest of the state-space variable be v[2],v[3],…,v[n].
    f[1]=0

    f[2]=v[2]*15.4793i - 1.0*v[5]*(- v[1]^3*(0.0000344811 - 0.0000411838i) + v[1]^2*(0.00239738 + 0.00406001i) + v[1]*(0.128199 + 0.108645i)) - 1.0*v[7]*(v[1]^3*(0.00028883 - 0.000720132i) + v[1]^2*(0.0132244 - 0.0199877i) + v[1]*(0.167761 - 0.219131i)) + ka2*(- v[2]*v[3]*(0.00329 + 0.00786i) + v[2]*v[4]*(0.00457 + 0.00683i) - v[2]*v[5]*(0.00165 + 0.00805i) - v[3]*v[4]*(0.00457 + 0.00683i) - v[2]*v[6]*(0.00018 - 0.00007i) + v[3]*v[5]*(0.00165 + 0.00805i) - v[2]*v[7]*(0.00006 - 0.00002i) + v[3]*v[6]*(0.00018 - 0.00007i) - v[4]*v[5]*(0.00306 + 0.00731i) + v[3]*v[7]*(0.00006 - 0.00002i) - v[4]*v[6]*(0.00015 - 0.0001i) - v[4]*v[7]*(0.00005 - 0.00003i) + v[5]*v[6]*(0.00018 - 0.00004i) + v[5]*v[7]*(0.00006 - 0.00001i) + v[2]^2*(0.00164 + 0.00393i) + v[3]^2*(0.00164 + 0.00393i) + v[4]^2*(0.00279 + 0.00281i) + v[5]^2*(0.00004 + 0.00396i)) - 1.0*v[6]*(- v[1]^3*(0.0000447835 - 0.000111657i) + v[1]^2*(0.00116393 - 0.00491519i) + v[1]*(0.113807 - 0.0877385i)) + v[4]*(v[1]^3*(0.00000353325 - 0.0000535964i) + v[1]^2*(0.00520619 - 0.00123418i) + v[1]*(0.167966 + 0.0119843i)) - 1.0*v[3]*(- v[1]^3*(6.45125e-7 - 0.000040738i) + v[1]^2*(0.00381858 + 0.00281874i) + v[1]*(0.150471 + 0.0573303i)) + v[2]*(v[1]^3*(0.0000276837 - 0.0000298934i) + v[1]^2*(0.00508047 + 0.000946023i) + v[1]*(0.136146 + 0.057017i)) + ka3*(v[2]*v[3]^2*(0.0007 - 0.00029i) - v[2]^2*v[3]*(0.0007 - 0.00029i) + v[2]*v[4]^2*(0.0005 - 0.0005i) + v[2]^2*v[4]*(0.00061 - 0.00041i) + v[2]*v[5]^2*(0.00071 - 0.00001i) - v[3]*v[4]^2*(0.0005 - 0.0005i) - v[2]^2*v[5]*(0.00072 - 0.00015i) + v[3]^2*v[4]*(0.00061 - 0.00041i) - v[3]*v[5]^2*(0.00071 - 0.00001i) + v[2]^2*v[6]*(0.00001 + 0.00002i) - v[3]^2*v[5]*(0.00072 - 0.00015i) + v[4]*v[5]^2*(0.00067 - 0.00014i) + v[3]^2*v[6]*(0.00001 + 0.00002i) - v[4]^2*v[5]*(0.00057 - 0.00038i) + v[4]^2*v[6]*(0.00001 + 0.00001i) + v[5]^2*v[6]*0.00002i + v[2]^3*(0.00023 - 0.0001i) - v[3]^3*(0.00023 - 0.0001i) + v[4]^3*(0.00013 - 0.00019i) - v[5]^3*(0.00022 + 0.00004i) - v[2]*v[3]*v[4]*(0.00122 - 0.00082i) + v[2]*v[3]*v[5]*(0.00144 - 0.0003i) - v[2]*v[3]*v[6]*(0.00001 + 0.00003i) - v[2]*v[4]*v[5]*(0.00131 - 0.00055i) - v[2]*v[3]*v[7]*0.00001i + v[2]*v[4]*v[6]*(0.00002 + 0.00003i) + v[3]*v[4]*v[5]*(0.00131 - 0.00055i) + v[2]*v[4]*v[7]*(0.00001 + 0.00001i) - v[2]*v[5]*v[6]*(0.00001 + 0.00003i) - v[3]*v[4]*v[6]*(0.00002 + 0.00003i) - v[2]*v[5]*v[7]*0.00001i - v[3]*v[4]*v[7]*(0.00001 + 0.00001i) + v[3]*v[5]*v[6]*(0.00001 + 0.00003i) + v[3]*v[5]*v[7]*0.00001i - v[4]*v[5]*v[6]*(0.00001 + 0.00003i) - v[4]*v[5]*v[7]*0.00001i)

    f[3]=- v[4]*(3.22105 - 16.4334i) + ka3*(0.00001*v[2]^2*v[7] + v[2]^2*v[3]*(0.00042 + 0.00167i) - v[2]*v[4]^2*(0.00095 + 0.00129i) - v[2]^2*v[4]*(0.00071 + 0.0015i) + v[2]*v[5]^2*(0.00022 - 0.00158i) + v[3]*v[4]^2*(0.00095 + 0.00129i) + v[2]^2*v[5]*(0.00009 + 0.00165i) - v[3]^2*v[4]*(0.00071 + 0.0015i) - v[3]*v[5]^2*(0.00022 - 0.00158i) + v[2]^2*v[6]*(0.00004 - 0.00001i) + v[3]^2*v[5]*(0.00009 + 0.00165i) - v[4]*v[5]^2*(0.00008 + 0.00154i) - v[2]*v[3]^2*(0.00042 + 0.00167i) + v[3]^2*v[6]*(0.00004 - 0.00001i) + v[4]^2*v[5]*(0.00066 + 0.00139i) + 0.00001*v[3]^2*v[7] + v[4]^2*v[6]*(0.00003 - 0.00002i) + v[4]^2*v[7]*(0.00001 - 0.00001i) + 0.00004*v[5]^2*v[6] + 0.00001*v[5]^2*v[7] - v[2]^3*(0.00014 + 0.00056i) + v[3]^3*(0.00014 + 0.00056i) - v[4]^3*(0.00038 + 0.00035i) - v[5]^3*(0.00017 - 0.00049i) + v[2]*v[3]*v[4]*(0.00142 + 0.003i) - v[2]*v[3]*v[5]*(0.00018 + 0.00331i) - v[2]*v[3]*v[6]*(0.00007 - 0.00002i) + v[2]*v[4]*v[5]*(0.00078 + 0.0031i) - v[2]*v[3]*v[7]*(0.00002 - 0.00001i) + v[2]*v[4]*v[6]*(0.00007 - 0.00003i) - v[3]*v[4]*v[5]*(0.00078 + 0.0031i) + v[2]*v[4]*v[7]*(0.00002 - 0.00001i) - 0.00007*v[2]*v[5]*v[6] - v[3]*v[4]*v[6]*(0.00007 - 0.00003i) - 0.00002*v[2]*v[5]*v[7] - v[3]*v[4]*v[7]*(0.00002 - 0.00001i) + 0.00007*v[3]*v[5]*v[6] + 0.00002*v[3]*v[5]*v[7] - v[4]*v[5]*v[6]*(0.00007 - 0.00002i) - v[4]*v[5]*v[7]*(0.00002 - 0.00001i)) - 1.0*v[2]*(v[1]^3*(0.0000420472 - 0.0000200759i) + v[1]^2*(0.00501926 + 0.00319374i) + v[1]*(0.152099 + 0.126793i)) + v[7]*(v[1]^3*(0.000611125 - 0.000643319i) + v[1]^2*(0.0231344 - 0.0150345i) + v[1]*(0.280706 - 0.152463i)) + v[6]*(- v[1]^3*(0.0000947556 - 0.0000997473i) + v[1]^2*(0.00321416 - 0.00482834i) + v[1]*(0.169289 - 0.0352994i)) + v[3]*(- v[1]^3*(0.0000178927 - 0.0000430216i) + v[1]^2*(0.00282464 + 0.00459i) + v[1]*(0.104275 + 0.115717i)) + ka2*(- v[2]*v[3]*(0.01859 - 0.00471i) + v[2]*v[4]*(0.01672 - 0.00791i) - v[2]*v[5]*(0.01846 - 0.00101i) - v[3]*v[4]*(0.01672 - 0.00791i) + v[2]*v[6]*(0.00011 + 0.00042i) + v[3]*v[5]*(0.01846 - 0.00101i) + v[2]*v[7]*(0.00003 + 0.00013i) - v[3]*v[6]*(0.00011 + 0.00042i) - v[4]*v[5]*(0.01728 - 0.00438i) - v[3]*v[7]*(0.00003 + 0.00013i) + v[4]*v[6]*(0.00018 + 0.00037i) + v[4]*v[7]*(0.00006 + 0.00012i) - v[5]*v[6]*(0.00002 + 0.00041i) - v[5]*v[7]*(0.00001 + 0.00013i) + v[2]^2*(0.0093 - 0.00236i) + v[3]^2*(0.0093 - 0.00236i) + v[4]^2*(0.00717 - 0.00529i) + v[5]^2*(0.00883 + 0.00123i)) + v[5]*(- v[1]^3*(0.00005404 - 0.0000292036i) + v[1]^2*(0.000804306 + 0.00527276i) + v[1]*(0.0564505 + 0.15966i)) - 1.0*v[4]*(v[1]^3*(0.0000263932 - 0.0000554668i) + v[1]^2*(0.00610947 + 0.000914594i) + v[1]*(0.207125 + 0.0938587i))

    f[4]=- v[4]*(3.22105 - 16.4334i) + ka3*(0.00001*v[2]^2*v[7] + v[2]^2*v[3]*(0.00042 + 0.00167i) - v[2]*v[4]^2*(0.00095 + 0.00129i) - v[2]^2*v[4]*(0.00071 + 0.0015i) + v[2]*v[5]^2*(0.00022 - 0.00158i) + v[3]*v[4]^2*(0.00095 + 0.00129i) + v[2]^2*v[5]*(0.00009 + 0.00165i) - v[3]^2*v[4]*(0.00071 + 0.0015i) - v[3]*v[5]^2*(0.00022 - 0.00158i) + v[2]^2*v[6]*(0.00004 - 0.00001i) + v[3]^2*v[5]*(0.00009 + 0.00165i) - v[4]*v[5]^2*(0.00008 + 0.00154i) - v[2]*v[3]^2*(0.00042 + 0.00167i) + v[3]^2*v[6]*(0.00004 - 0.00001i) + v[4]^2*v[5]*(0.00066 + 0.00139i) + 0.00001*v[3]^2*v[7] + v[4]^2*v[6]*(0.00003 - 0.00002i) + v[4]^2*v[7]*(0.00001 - 0.00001i) + 0.00004*v[5]^2*v[6] + 0.00001*v[5]^2*v[7] - v[2]^3*(0.00014 + 0.00056i) + v[3]^3*(0.00014 + 0.00056i) - v[4]^3*(0.00038 + 0.00035i) - v[5]^3*(0.00017 - 0.00049i) + v[2]*v[3]*v[4]*(0.00142 + 0.003i) - v[2]*v[3]*v[5]*(0.00018 + 0.00331i) - v[2]*v[3]*v[6]*(0.00007 - 0.00002i) + v[2]*v[4]*v[5]*(0.00078 + 0.0031i) - v[2]*v[3]*v[7]*(0.00002 - 0.00001i) + v[2]*v[4]*v[6]*(0.00007 - 0.00003i) - v[3]*v[4]*v[5]*(0.00078 + 0.0031i) + v[2]*v[4]*v[7]*(0.00002 - 0.00001i) - 0.00007*v[2]*v[5]*v[6] - v[3]*v[4]*v[6]*(0.00007 - 0.00003i) - 0.00002*v[2]*v[5]*v[7] - v[3]*v[4]*v[7]*(0.00002 - 0.00001i) + 0.00007*v[3]*v[5]*v[6] + 0.00002*v[3]*v[5]*v[7] - v[4]*v[5]*v[6]*(0.00007 - 0.00002i) - v[4]*v[5]*v[7]*(0.00002 - 0.00001i)) - 1.0*v[2]*(v[1]^3*(0.0000420472 - 0.0000200759i) + v[1]^2*(0.00501926 + 0.00319374i) + v[1]*(0.152099 + 0.126793i)) + v[7]*(v[1]^3*(0.000611125 - 0.000643319i) + v[1]^2*(0.0231344 - 0.0150345i) + v[1]*(0.280706 - 0.152463i)) + v[6]*(- v[1]^3*(0.0000947556 - 0.0000997473i) + v[1]^2*(0.00321416 - 0.00482834i) + v[1]*(0.169289 - 0.0352994i)) + v[3]*(- v[1]^3*(0.0000178927 - 0.0000430216i) + v[1]^2*(0.00282464 + 0.00459i) + v[1]*(0.104275 + 0.115717i)) + ka2*(- v[2]*v[3]*(0.01859 - 0.00471i) + v[2]*v[4]*(0.01672 - 0.00791i) - v[2]*v[5]*(0.01846 - 0.00101i) - v[3]*v[4]*(0.01672 - 0.00791i) + v[2]*v[6]*(0.00011 + 0.00042i) + v[3]*v[5]*(0.01846 - 0.00101i) + v[2]*v[7]*(0.00003 + 0.00013i) - v[3]*v[6]*(0.00011 + 0.00042i) - v[4]*v[5]*(0.01728 - 0.00438i) - v[3]*v[7]*(0.00003 + 0.00013i) + v[4]*v[6]*(0.00018 + 0.00037i) + v[4]*v[7]*(0.00006 + 0.00012i) - v[5]*v[6]*(0.00002 + 0.00041i) - v[5]*v[7]*(0.00001 + 0.00013i) + v[2]^2*(0.0093 - 0.00236i) + v[3]^2*(0.0093 - 0.00236i) + v[4]^2*(0.00717 - 0.00529i) + v[5]^2*(0.00883 + 0.00123i)) + v[5]*(- v[1]^3*(0.00005404 - 0.0000292036i) + v[1]^2*(0.000804306 + 0.00527276i) + v[1]*(0.0564505 + 0.15966i)) - 1.0*v[4]*(v[1]^3*(0.0000263932 - 0.0000554668i) + v[1]^2*(0.00610947 + 0.000914594i) + v[1]*(0.207125 + 0.0938587i))

    f[5]=- v[5]*(3.22105 + 16.4334i) + ka3*(v[2]*v[3]^2*(0.00042 - 0.00167i) - v[2]^2*v[3]*(0.00042 - 0.00167i) - v[2]*v[4]^2*(0.00022 + 0.00158i) + v[2]^2*v[4]*(0.00009 - 0.00165i) + v[2]*v[5]^2*(0.00095 - 0.00129i) + v[3]*v[4]^2*(0.00022 + 0.00158i) - v[2]^2*v[5]*(0.00071 - 0.0015i) + v[3]^2*v[4]*(0.00009 - 0.00165i) - v[3]*v[5]^2*(0.00095 - 0.00129i) + v[2]^2*v[6]*(0.00004 + 0.00001i) - v[3]^2*v[5]*(0.00071 - 0.0015i) + v[4]*v[5]^2*(0.00066 - 0.00139i) + 0.00001*v[2]^2*v[7] + v[3]^2*v[6]*(0.00004 + 0.00001i) - v[4]^2*v[5]*(0.00008 - 0.00154i) + 0.00001*v[3]^2*v[7] + 0.00004*v[4]^2*v[6] + 0.00001*v[4]^2*v[7] + v[5]^2*v[6]*(0.00003 + 0.00002i) + v[5]^2*v[7]*(0.00001 + 0.00001i) + v[2]^3*(0.00014 - 0.00056i) - v[3]^3*(0.00014 - 0.00056i) - v[4]^3*(0.00017 + 0.00049i) - v[5]^3*(0.00038 - 0.00035i) - v[2]*v[3]*v[4]*(0.00018 - 0.00331i) + v[2]*v[3]*v[5]*(0.00142 - 0.003i) - v[2]*v[3]*v[6]*(0.00007 + 0.00002i) - v[2]*v[4]*v[5]*(0.00078 - 0.0031i) - v[2]*v[3]*v[7]*(0.00002 + 0.00001i) + 0.00007*v[2]*v[4]*v[6] + v[3]*v[4]*v[5]*(0.00078 - 0.0031i) + 0.00002*v[2]*v[4]*v[7] - v[2]*v[5]*v[6]*(0.00007 + 0.00003i) - 0.00007*v[3]*v[4]*v[6] - v[2]*v[5]*v[7]*(0.00002 + 0.00001i) - 0.00002*v[3]*v[4]*v[7] + v[3]*v[5]*v[6]*(0.00007 + 0.00003i) + v[3]*v[5]*v[7]*(0.00002 + 0.00001i) - v[4]*v[5]*v[6]*(0.00007 + 0.00002i) - v[4]*v[5]*v[7]*(0.00002 + 0.00001i)) - 1.0*v[3]*(v[1]^3*(0.0000420472 + 0.0000200759i) + v[1]^2*(0.00501926 - 0.00319374i) + v[1]*(0.152099 - 0.126793i)) + v[7]*(v[1]^3*(0.000611125 + 0.000643319i) + v[1]^2*(0.0231344 + 0.0150345i) + v[1]*(0.280706 + 0.152463i)) + v[6]*(- v[1]^3*(0.0000947556 + 0.0000997473i) + v[1]^2*(0.00321416 + 0.00482834i) + v[1]*(0.169289 + 0.0352994i)) + v[2]*(- v[1]^3*(0.0000178927 + 0.0000430216i) + v[1]^2*(0.00282464 - 0.00459i) + v[1]*(0.104275 - 0.115717i)) + ka2*(- v[2]*v[3]*(0.01859 + 0.00471i) + v[2]*v[4]*(0.01846 + 0.00101i) - v[2]*v[5]*(0.01672 + 0.00791i) - v[3]*v[4]*(0.01846 + 0.00101i) - v[2]*v[6]*(0.00011 - 0.00042i) + v[3]*v[5]*(0.01672 + 0.00791i) - v[2]*v[7]*(0.00003 - 0.00013i) + v[3]*v[6]*(0.00011 - 0.00042i) - v[4]*v[5]*(0.01728 + 0.00438i) + v[3]*v[7]*(0.00003 - 0.00013i) - v[4]*v[6]*(0.00002 - 0.00041i) - v[4]*v[7]*(0.00001 - 0.00013i) + v[5]*v[6]*(0.00018 - 0.00037i) + v[5]*v[7]*(0.00006 - 0.00012i) + v[2]^2*(0.0093 + 0.00236i) + v[3]^2*(0.0093 + 0.00236i) + v[4]^2*(0.00883 - 0.00123i) + v[5]^2*(0.00717 + 0.00529i)) + v[4]*(- v[1]^3*(0.00005404 + 0.0000292036i) + v[1]^2*(0.000804306 - 0.00527276i) + v[1]*(0.0564505 - 0.15966i)) - 1.0*v[5]*(v[1]^3*(0.0000263932 + 0.0000554668i) + v[1]^2*(0.00610947 - 0.000914594i) + v[1]*(0.207125 - 0.0938587i))

    f[6]=- 35.42*v[6] + ka2*(0.00156*v[2]^2 + v[2]*v[4]*(0.00296 - 0.00058i) - v[2]*v[5]*(0.00296 + 0.00058i) - v[3]*v[4]*(0.00296 - 0.00058i) + v[2]*v[6]*0.00007i + v[3]*v[5]*(0.00296 + 0.00058i) + v[2]*v[7]*0.00002i - v[3]*v[6]*0.00007i - 0.00291*v[4]*v[5] - v[3]*v[7]*0.00002i + v[4]*v[6]*(0.00001 + 0.00007i) + v[4]*v[7]*0.00002i + v[5]*v[6]*(0.00001 - 0.00007i) - v[5]*v[7]*0.00002i - 0.00313*v[2]*v[3] + 0.00156*v[3]^2 + v[4]^2*(0.00135 - 0.00055i) + v[5]^2*(0.00135 + 0.00055i)) + v[4]*(- v[1]^3*(0.0000100928 - 0.00000329552i) + v[1]^2*(0.00800912 - 0.00360892i) + v[1]*(0.277632 - 0.00848122i)) + v[5]*(- v[1]^3*(0.0000100928 + 0.00000329552i) + v[1]^2*(0.00800912 + 0.00360892i) + v[1]*(0.277632 + 0.00848122i)) - 1.0*ka3*(v[2]^3*0.00009i - v[2]^2*v[3]*0.00028i + v[2]^2*v[4]*(0.00005 + 0.00027i) + v[2]^2*v[5]*(0.00005 - 0.00027i) - 0.00001*v[6]*v[2]^2 + v[2]*v[3]^2*0.00028i - v[2]*v[3]*v[4]*(0.0001 + 0.00053i) - v[2]*v[3]*v[5]*(0.0001 - 0.00053i) + 0.00001*v[6]*v[2]*v[3] + v[2]*v[4]^2*(0.0001 + 0.00024i) - v[2]*v[4]*v[5]*0.00052i - 0.00001*v[6]*v[2]*v[4] - v[2]*v[5]^2*(0.0001 - 0.00024i) + 0.00001*v[6]*v[2]*v[5] - v[3]^3*0.00009i + v[3]^2*v[4]*(0.00005 + 0.00027i) + v[3]^2*v[5]*(0.00005 - 0.00027i) - 0.00001*v[6]*v[3]^2 - v[3]*v[4]^2*(0.0001 + 0.00024i) + v[3]*v[4]*v[5]*0.00052i + 0.00001*v[6]*v[3]*v[4] + v[3]*v[5]^2*(0.0001 - 0.00024i) - 0.00001*v[6]*v[3]*v[5] + v[4]^3*(0.00005 + 0.00007i) - v[4]^2*v[5]*(0.00005 + 0.00025i) - 0.00001*v[6]*v[4]^2 - v[4]*v[5]^2*(0.00005 - 0.00025i) + 0.00001*v[6]*v[4]*v[5] + v[5]^3*(0.00005 - 0.00007i) - 0.00001*v[6]*v[5]^2) - 1.0*v[7]*(- v[1]^3*(0.000153368 - 3.3098e-20i) + v[1]^2*(0.126015 + 1.35887e-18i) + v[1]*(1.95201 + 1.68276e-17i)) + v[2]*(- v[1]^3*(0.00000752126 + 0.00000287923i) + v[1]^2*(0.0061892 + 0.00149802i) + v[1]*(0.0833156 - 0.0381373i)) + v[3]*(- v[1]^3*(0.00000752126 - 0.00000287923i) + v[1]^2*(0.0061892 - 0.00149802i) + v[1]*(0.0833156 + 0.0381373i)) - 1.0*v[6]*(v[1]^3*(0.0000237799 - 5.13187e-21i) - v[1]^2*(0.0212456 - 1.57651e-19i) + v[1]*(1.96145 + 1.07687e-17i))

    f[7]=- 5.41329*v[7] - 1.0*v[6]*(v[1]^3*(0.0000032869 - 4.60936e-22i) - v[1]^2*(0.00321098 + 2.22918e-19i) + v[1]*(0.297817 + 2.42034e-17i)) + v[4]*(- v[1]^3*(0.00000139504 - 4.55513e-7i) + v[1]^2*(0.00122348 - 0.000536855i) + v[1]*(0.0383104 - 0.000859108i)) + v[5]*(- v[1]^3*(0.00000139504 + 4.55513e-7i) + v[1]^2*(0.00122348 + 0.000536855i) + v[1]*(0.0383104 + 0.000859108i)) + v[2]*(- v[1]^3*(0.0000010396 + 3.97973e-7i) + v[1]^2*(0.000942262 + 0.000240279i) + v[1]*(0.00883636 - 0.00537487i)) + v[3]*(- v[1]^3*(0.0000010396 - 3.97973e-7i) + v[1]^2*(0.000942262 - 0.000240279i) + v[1]*(0.00883636 + 0.00537487i)) - 1.0*v[7]*(- v[1]^3*(0.0000211988 - 2.9728e-21i) + v[1]^2*(0.0191876 + 1.65108e-18i) + v[1]*(0.29695 + 2.49701e-17i)) + ka2*(0.00138*v[2]^2 + v[2]*v[4]*(0.00261 - 0.00051i) - v[2]*v[5]*(0.00261 + 0.00051i) - v[3]*v[4]*(0.00261 - 0.00051i) + v[2]*v[6]*0.00006i + v[3]*v[5]*(0.00261 + 0.00051i) + v[2]*v[7]*0.00002i - v[3]*v[6]*0.00006i - 0.00256*v[4]*v[5] - v[3]*v[7]*0.00002i + v[4]*v[6]*(0.00001 + 0.00006i) + v[4]*v[7]*0.00002i + v[5]*v[6]*(0.00001 - 0.00006i) - v[5]*v[7]*0.00002i - 0.00276*v[2]*v[3] + 0.00138*v[3]^2 + v[4]^2*(0.00119 - 0.00048i) + v[5]^2*(0.00119 + 0.00048i)) - 1.0*ka3*(v[2]^3*0.00008i - v[2]^2*v[3]*0.00025i + v[2]^2*v[4]*(0.00005 + 0.00023i) + v[2]^2*v[5]*(0.00005 - 0.00023i) - 0.00001*v[6]*v[2]^2 + v[2]*v[3]^2*0.00025i - v[2]*v[3]*v[4]*(0.00009 + 0.00047i) - v[2]*v[3]*v[5]*(0.00009 - 0.00047i) + 0.00001*v[6]*v[2]*v[3] + v[2]*v[4]^2*(0.00009 + 0.00021i) - v[2]*v[4]*v[5]*0.00046i - 0.00001*v[6]*v[2]*v[4] - v[2]*v[5]^2*(0.00009 - 0.00021i) + 0.00001*v[6]*v[2]*v[5] - v[3]^3*0.00008i + v[3]^2*v[4]*(0.00005 + 0.00023i) + v[3]^2*v[5]*(0.00005 - 0.00023i) - 0.00001*v[6]*v[3]^2 - v[3]*v[4]^2*(0.00009 + 0.00021i) + v[3]*v[4]*v[5]*0.00046i + 0.00001*v[6]*v[3]*v[4] + v[3]*v[5]^2*(0.00009 - 0.00021i) - 0.00001*v[6]*v[3]*v[5] + v[4]^3*(0.00004 + 0.00006i) - v[4]^2*v[5]*(0.00004 + 0.00022i) - v[4]*v[5]^2*(0.00004 - 0.00022i) + 0.00001*v[6]*v[4]*v[5] + v[5]^3*(0.00004 - 0.00006i))

    f[2] = f[2]/ω_h; f[3] = f[3]/ω_h; f[4] = f[4]/ω_h; f[5] = f[5]/ω_h; f[6] = f[6]/ω_h; f[7] = f[7]/ω_h

    return calculate_normal_form(f, v, norder, cm, m1, m2, m3, n, ω_h, zero_tol)
end


function example2()
    norder = 3; # Choose the order of power series representation of Centermanifold
    cm = 3; # Dimension of Centermanifold of the dynamical system
    m1 = 1; # Number of the zero eigenvalue corresponding to the center space of the Jacobian
    m2 = 1; # Number of pair of complex conjugate eigenvalue corresponding to the center space of the Jacobian
    m3 = 4; # Dimension of the stable manifold of the dynmical system
    n = m1+2*m2+m3; # Total dimension of the dynamical system
    ω_h = 15.1829; # Eigenvalue that crosses unit circle at Hopf bifurcation point ± ω_h
    zero_tol = 1e-13; # zero tolerance to chop out very small coeffs of symbolic computation

    v = [symbols("v_$i") for i in 1:n]; # Define state-space variables
    f = Array{Basic}(undef, n);

    @vars ka2, ka3, ν  # Define symbolic variables which is needed to define the equation of motion
    # In this example the variables are nonlinear stifness parameters

    # Define the equation of motion at the Hopf bifurcation point where the dimension of centermanifold is 2
    # Let the dimension of control parameter vector be 1, and express it as a one of state-space variable v[1]
    # d/dt v[1]=0 and let rest of the state-space variable be v[2],v[3],…,v[n].

    f[1]=0

    f[1]=0

    f[2]=v[2]*15.1829i + v[4]*(v[1]^3*(0.00000311958 - 0.000034438i) + v[1]^2*(0.00343708 - 0.00109031i) + v[1]*(0.143011 + 0.00225607i)) - 1.0*v[7]*(v[1]^3*(0.000169667 - 0.000348283i) + v[1]^2*(0.009276 - 0.0122307i) + v[1]*(0.154139 - 0.176441i)) - 1.0*ka2*(v[2]*v[3]*(0.00211 + 0.00537i) - v[2]*v[4]*(0.00357 + 0.00452i) + v[2]*v[5]*(0.00047 + 0.00574i) + v[3]*v[4]*(0.00357 + 0.00452i) - v[2]*v[6]*(0.00015 - 0.00006i) - v[3]*v[5]*(0.00047 + 0.00574i) + v[2]*v[7]*(0.00012 - 0.00005i) + v[3]*v[6]*(0.00015 - 0.00006i) + v[4]*v[5]*(0.00211 + 0.00535i) - v[3]*v[7]*(0.00012 - 0.00005i) - v[4]*v[6]*(0.00013 - 0.0001i) + v[4]*v[7]*(0.0001 - 0.00008i) + v[5]*v[6]*(0.00016 - 0.00001i) - v[5]*v[7]*(0.00013 - 0.00001i) - v[2]^2*(0.00106 + 0.00268i) - v[3]^2*(0.00106 + 0.00268i) - v[4]^2*(0.00235 + 0.00165i) + v[5]^2*(0.0006 - 0.00281i)) + v[2]*(v[1]^3*(0.0000207736 - 0.0000108138i) + v[1]^2*(0.00314984 + 0.00104467i) + v[1]*(0.103133 + 0.0572328i)) - 1.0*v[3]*(v[1]^3*(0.00000428964 + 0.0000230234i) + v[1]^2*(0.00240965 + 0.00190241i) + v[1]*(0.120388 + 0.0527565i)) + v[6]*(- v[1]^3*(0.0000259479 - 0.0000532643i) + v[1]^2*(0.00106845 - 0.00323481i) + v[1]*(0.0949347 - 0.0606467i)) - 1.0*v[5]*(- v[1]^3*(0.0000251947 - 0.000023684i) + v[1]^2*(0.000895386 + 0.00299059i) + v[1]*(0.0879635 + 0.11187i)) + ka3*(v[2]*v[3]^2*(0.00044 - 0.00017i) - v[2]^2*v[3]*(0.00044 - 0.00017i) + v[2]*v[4]^2*(0.00027 - 0.00039i) + v[2]^2*v[4]*(0.00037 - 0.00029i) + v[2]*v[5]^2*(0.00046 + 0.0001i) - v[3]*v[4]^2*(0.00027 - 0.00039i) - v[2]^2*v[5]*(0.00047 - 0.00004i) + v[3]^2*v[4]*(0.00037 - 0.00029i) - v[3]*v[5]^2*(0.00046 + 0.0001i) - v[2]^2*v[6]*0.00001i - v[3]^2*v[5]*(0.00047 - 0.00004i) + v[4]*v[5]^2*(0.00047 - 0.00004i) + v[2]^2*v[7]*0.00001i - v[3]^2*v[6]*0.00001i - v[4]^2*v[5]*(0.00037 - 0.00029i) + v[3]^2*v[7]*0.00001i - v[4]^2*v[6]*(0.00001 + 0.00001i) + v[4]^2*v[7]*(0.00001 + 0.00001i) - v[5]^2*v[6]*0.00001i + v[5]^2*v[7]*0.00001i + v[2]^3*(0.00015 - 0.00006i) - v[3]^3*(0.00015 - 0.00006i) + v[4]^3*(0.00005 - 0.00015i) - v[5]^3*(0.00014 + 0.00008i) - v[2]*v[3]*v[4]*(0.00074 - 0.00059i) + v[2]*v[3]*v[5]*(0.00094 - 0.00008i) + v[2]*v[3]*v[6]*(0.00001 + 0.00003i) - v[2]*v[4]*v[5]*(0.00088 - 0.00035i) - v[2]*v[3]*v[7]*(0.00001 + 0.00002i) - v[2]*v[4]*v[6]*(0.00002 + 0.00002i) + v[3]*v[4]*v[5]*(0.00088 - 0.00035i) + v[2]*v[4]*v[7]*(0.00001 + 0.00002i) + v[2]*v[5]*v[6]*0.00003i + v[3]*v[4]*v[6]*(0.00002 + 0.00002i) - v[2]*v[5]*v[7]*0.00002i - v[3]*v[4]*v[7]*(0.00001 + 0.00002i) - v[3]*v[5]*v[6]*0.00003i + v[3]*v[5]*v[7]*0.00002i + v[4]*v[5]*v[6]*(0.00001 + 0.00003i) - v[4]*v[5]*v[7]*(0.00001 + 0.00002i))

    f[3]=- v[3]*15.1829i + v[5]*(v[1]^3*(0.00000311958 + 0.000034438i) + v[1]^2*(0.00343708 + 0.00109031i) + v[1]*(0.143011 - 0.00225607i)) - 1.0*v[7]*(v[1]^3*(0.000169667 + 0.000348283i) + v[1]^2*(0.009276 + 0.0122307i) + v[1]*(0.154139 + 0.176441i)) - 1.0*ka2*(v[2]*v[3]*(0.00211 - 0.00537i) - v[2]*v[4]*(0.00047 - 0.00574i) + v[2]*v[5]*(0.00357 - 0.00452i) + v[3]*v[4]*(0.00047 - 0.00574i) + v[2]*v[6]*(0.00015 + 0.00006i) - v[3]*v[5]*(0.00357 - 0.00452i) - v[2]*v[7]*(0.00012 + 0.00005i) - v[3]*v[6]*(0.00015 + 0.00006i) + v[4]*v[5]*(0.00211 - 0.00535i) + v[3]*v[7]*(0.00012 + 0.00005i) + v[4]*v[6]*(0.00016 + 0.00001i) - v[4]*v[7]*(0.00013 + 0.00001i) - v[5]*v[6]*(0.00013 + 0.0001i) + v[5]*v[7]*(0.0001 + 0.00008i) - v[2]^2*(0.00106 - 0.00268i) - v[3]^2*(0.00106 - 0.00268i) + v[4]^2*(0.0006 + 0.00281i) - v[5]^2*(0.00235 - 0.00165i)) + v[3]*(v[1]^3*(0.0000207736 + 0.0000108138i) + v[1]^2*(0.00314984 - 0.00104467i) + v[1]*(0.103133 - 0.0572328i)) - 1.0*v[2]*(v[1]^3*(0.00000428964 - 0.0000230234i) + v[1]^2*(0.00240965 - 0.00190241i) + v[1]*(0.120388 - 0.0527565i)) + v[6]*(- v[1]^3*(0.0000259479 + 0.0000532643i) + v[1]^2*(0.00106845 + 0.00323481i) + v[1]*(0.0949347 + 0.0606467i)) - 1.0*v[4]*(- v[1]^3*(0.0000251947 + 0.000023684i) + v[1]^2*(0.000895386 - 0.00299059i) + v[1]*(0.0879635 - 0.11187i)) - 1.0*ka3*(v[2]*v[3]^2*(0.00044 + 0.00017i) - v[2]^2*v[3]*(0.00044 + 0.00017i) + v[2]*v[4]^2*(0.00046 - 0.0001i) + v[2]^2*v[4]*(0.00047 + 0.00004i) + v[2]*v[5]^2*(0.00027 + 0.00039i) - v[3]*v[4]^2*(0.00046 - 0.0001i) - v[2]^2*v[5]*(0.00037 + 0.00029i) + v[3]^2*v[4]*(0.00047 + 0.00004i) - v[3]*v[5]^2*(0.00027 + 0.00039i) - v[2]^2*v[6]*0.00001i - v[3]^2*v[5]*(0.00037 + 0.00029i) + v[4]*v[5]^2*(0.00037 + 0.00029i) + v[2]^2*v[7]*0.00001i - v[3]^2*v[6]*0.00001i - v[4]^2*v[5]*(0.00047 + 0.00004i) + v[3]^2*v[7]*0.00001i - v[4]^2*v[6]*0.00001i + v[4]^2*v[7]*0.00001i + v[5]^2*v[6]*(0.00001 - 0.00001i) - v[5]^2*v[7]*(0.00001 - 0.00001i) + v[2]^3*(0.00015 + 0.00006i) - v[3]^3*(0.00015 + 0.00006i) + v[4]^3*(0.00014 - 0.00008i) - v[5]^3*(0.00005 + 0.00015i) - v[2]*v[3]*v[4]*(0.00094 + 0.00008i) + v[2]*v[3]*v[5]*(0.00074 + 0.00059i) - v[2]*v[3]*v[6]*(0.00001 - 0.00003i) - v[2]*v[4]*v[5]*(0.00088 + 0.00035i) + v[2]*v[3]*v[7]*(0.00001 - 0.00002i) - v[2]*v[4]*v[6]*0.00003i + v[3]*v[4]*v[5]*(0.00088 + 0.00035i) + v[2]*v[4]*v[7]*0.00002i - v[2]*v[5]*v[6]*(0.00002 - 0.00002i) + v[3]*v[4]*v[6]*0.00003i + v[2]*v[5]*v[7]*(0.00001 - 0.00002i) - v[3]*v[4]*v[7]*0.00002i + v[3]*v[5]*v[6]*(0.00002 - 0.00002i) - v[3]*v[5]*v[7]*(0.00001 - 0.00002i) - v[4]*v[5]*v[6]*(0.00001 - 0.00003i) + v[4]*v[5]*v[7]*(0.00001 - 0.00002i))

    f[4]=- v[4]*(5.05926 - 16.7804i) + v[7]*(v[1]^3*(0.000397449 - 0.000246334i) + v[1]^2*(0.0177999 - 0.00583005i) + v[1]*(0.280611 - 0.0666978i)) - 1.0*v[4]*(v[1]^3*(0.0000253568 - 0.00003315i) + v[1]^2*(0.00427065 + 0.00114243i) + v[1]*(0.176935 + 0.10919i)) - 1.0*v[5]*(v[1]^3*(0.0000409701 - 0.00000795858i) + v[1]^2*(0.0010276 - 0.00355808i) + v[1]*(0.0149366 - 0.156251i)) - 1.0*ka3*(v[2]*v[3]^2*(0.00006 + 0.00136i) - v[2]^2*v[3]*(0.00006 + 0.00136i) + v[2]*v[4]^2*(0.00079 + 0.0011i) + v[2]^2*v[4]*(0.00045 + 0.00128i) - v[2]*v[5]^2*(0.0007 - 0.00116i) - v[3]*v[4]^2*(0.00079 + 0.0011i) + v[2]^2*v[5]*(0.00034 - 0.00131i) + v[3]^2*v[4]*(0.00045 + 0.00128i) + v[3]*v[5]^2*(0.0007 - 0.00116i) + 0.00004*v[2]^2*v[6] + v[3]^2*v[5]*(0.00034 - 0.00131i) - v[4]*v[5]^2*(0.00034 - 0.00131i) - 0.00003*v[2]^2*v[7] + 0.00004*v[3]^2*v[6] - v[4]^2*v[5]*(0.00044 + 0.00128i) - 0.00003*v[3]^2*v[7] + v[4]^2*v[6]*(0.00003 - 0.00002i) - v[4]^2*v[7]*(0.00002 - 0.00002i) + v[5]^2*v[6]*(0.00003 + 0.00002i) - v[5]^2*v[7]*(0.00003 + 0.00002i) + v[2]^3*(0.00002 + 0.00045i) - v[3]^3*(0.00002 + 0.00045i) + v[4]^3*(0.00036 + 0.00027i) + v[5]^3*(0.00033 - 0.0003i) - v[2]*v[3]*v[4]*(0.00089 + 0.00256i) - v[2]*v[3]*v[5]*(0.00067 - 0.00263i) - 0.00008*v[2]*v[3]*v[6] - v[2]*v[4]*v[5]*(0.00011 + 0.0027i) + 0.00006*v[2]*v[3]*v[7] + v[2]*v[4]*v[6]*(0.00007 - 0.00003i) + v[3]*v[4]*v[5]*(0.00011 + 0.0027i) - v[2]*v[4]*v[7]*(0.00006 - 0.00002i) - v[2]*v[5]*v[6]*(0.00008 + 0.00002i) - v[3]*v[4]*v[6]*(0.00007 - 0.00003i) + v[2]*v[5]*v[7]*(0.00006 + 0.00001i) + v[3]*v[4]*v[7]*(0.00006 - 0.00002i) + v[3]*v[5]*v[6]*(0.00008 + 0.00002i) - v[3]*v[5]*v[7]*(0.00006 + 0.00001i) - 0.00008*v[4]*v[5]*v[6] + 0.00006*v[4]*v[5]*v[7]) - 1.0*v[2]*(v[1]^3*(0.0000281704 + 0.00000233443i) + v[1]^2*(0.00254065 + 0.0031441i) + v[1]*(0.0954459 + 0.135962i)) - 1.0*v[6]*(- v[1]^3*(0.0000607835 - 0.0000376728i) + v[1]^2*(0.00310379 - 0.00271927i) + v[1]*(0.147457 + 0.0138217i)) + ka2*(v[2]^2*(0.00827 - 0.00035i) - v[2]*v[3]*(0.01654 - 0.0007i) + v[2]*v[4]*(0.0156 - 0.00543i) - v[2]*v[5]*(0.016 + 0.0041i) - v[2]*v[6]*(0.00002 + 0.00048i) + v[7]*v[2]*(0.00002 + 0.00036i) + v[3]^2*(0.00827 - 0.00035i) - v[3]*v[4]*(0.0156 - 0.00543i) + v[3]*v[5]*(0.016 + 0.0041i) + v[3]*v[6]*(0.00002 + 0.00048i) - v[7]*v[3]*(0.00002 + 0.00036i) + v[4]^2*(0.00667 - 0.00484i) - v[4]*v[5]*(0.01648 - 0.00069i) - v[4]*v[6]*(0.00016 + 0.00045i) + v[7]*v[4]*(0.00012 + 0.00034i) + v[5]^2*(0.00706 + 0.00426i) - v[5]*v[6]*(0.00012 - 0.00046i) + v[7]*v[5]*(0.00009 - 0.00035i) - 0.00001*v[6]^2 + 0.00001*v[7]*v[6]) + v[3]*(- v[1]^3*(0.0000104436 - 0.0000262669i) + v[1]^2*(0.0011885 + 0.00347674i) + v[1]*(0.0617113 + 0.120387i))

    f[5]=- v[5]*(5.05926 + 16.7804i) + v[7]*(v[1]^3*(0.000397449 + 0.000246334i) + v[1]^2*(0.0177999 + 0.00583005i) + v[1]*(0.280611 + 0.0666978i)) - 1.0*v[5]*(v[1]^3*(0.0000253568 + 0.00003315i) + v[1]^2*(0.00427065 - 0.00114243i) + v[1]*(0.176935 - 0.10919i)) - 1.0*v[4]*(v[1]^3*(0.0000409701 + 0.00000795858i) + v[1]^2*(0.0010276 + 0.00355808i) + v[1]*(0.0149366 + 0.156251i)) - 1.0*ka3*(0.00004*v[2]^2*v[6] + v[2]^2*v[3]*(0.00006 - 0.00136i) + v[2]*v[4]^2*(0.0007 + 0.00116i) + v[2]^2*v[4]*(0.00034 + 0.00131i) - v[2]*v[5]^2*(0.00079 - 0.0011i) - v[3]*v[4]^2*(0.0007 + 0.00116i) + v[2]^2*v[5]*(0.00045 - 0.00128i) + v[3]^2*v[4]*(0.00034 + 0.00131i) + v[3]*v[5]^2*(0.00079 - 0.0011i) - v[2]*v[3]^2*(0.00006 - 0.00136i) + v[3]^2*v[5]*(0.00045 - 0.00128i) - v[4]*v[5]^2*(0.00044 - 0.00128i) - 0.00003*v[2]^2*v[7] + 0.00004*v[3]^2*v[6] - v[4]^2*v[5]*(0.00034 + 0.00131i) - 0.00003*v[3]^2*v[7] + v[4]^2*v[6]*(0.00003 - 0.00002i) - v[4]^2*v[7]*(0.00003 - 0.00002i) + v[5]^2*v[6]*(0.00003 + 0.00002i) - v[5]^2*v[7]*(0.00002 + 0.00002i) - v[2]^3*(0.00002 - 0.00045i) + v[3]^3*(0.00002 - 0.00045i) + v[4]^3*(0.00033 + 0.0003i) + v[5]^3*(0.00036 - 0.00027i) - v[2]*v[3]*v[4]*(0.00067 + 0.00263i) - v[2]*v[3]*v[5]*(0.00089 - 0.00256i) - 0.00008*v[2]*v[3]*v[6] + v[2]*v[4]*v[5]*(0.00011 - 0.0027i) + 0.00006*v[2]*v[3]*v[7] + v[2]*v[4]*v[6]*(0.00008 - 0.00002i) - v[3]*v[4]*v[5]*(0.00011 - 0.0027i) - v[2]*v[4]*v[7]*(0.00006 - 0.00001i) - v[2]*v[5]*v[6]*(0.00007 + 0.00003i) - v[3]*v[4]*v[6]*(0.00008 - 0.00002i) + v[2]*v[5]*v[7]*(0.00006 + 0.00002i) + v[3]*v[4]*v[7]*(0.00006 - 0.00001i) + v[3]*v[5]*v[6]*(0.00007 + 0.00003i) - v[3]*v[5]*v[7]*(0.00006 + 0.00002i) - 0.00008*v[4]*v[5]*v[6] + 0.00006*v[4]*v[5]*v[7]) - 1.0*v[3]*(v[1]^3*(0.0000281704 - 0.00000233443i) + v[1]^2*(0.00254065 - 0.0031441i) + v[1]*(0.0954459 - 0.135962i)) - 1.0*v[6]*(- v[1]^3*(0.0000607835 + 0.0000376728i) + v[1]^2*(0.00310379 + 0.00271927i) + v[1]*(0.147457 - 0.0138217i)) + ka2*(v[2]^2*(0.00827 + 0.00035i) - v[2]*v[3]*(0.01654 + 0.0007i) + v[2]*v[4]*(0.016 - 0.0041i) - v[2]*v[5]*(0.0156 + 0.00543i) + v[2]*v[6]*(0.00002 - 0.00048i) - v[7]*v[2]*(0.00002 - 0.00036i) + v[3]^2*(0.00827 + 0.00035i) - v[3]*v[4]*(0.016 - 0.0041i) + v[3]*v[5]*(0.0156 + 0.00543i) - v[3]*v[6]*(0.00002 - 0.00048i) + v[7]*v[3]*(0.00002 - 0.00036i) + v[4]^2*(0.00706 - 0.00426i) - v[4]*v[5]*(0.01648 + 0.00069i) - v[4]*v[6]*(0.00012 + 0.00046i) + v[7]*v[4]*(0.00009 + 0.00035i) + v[5]^2*(0.00667 + 0.00484i) - v[5]*v[6]*(0.00016 - 0.00045i) + v[7]*v[5]*(0.00012 - 0.00034i) - 0.00001*v[6]^2 + 0.00001*v[7]*v[6]) + v[2]*(- v[1]^3*(0.0000104436 + 0.0000262669i) + v[1]^2*(0.0011885 - 0.00347674i) + v[1]*(0.0617113 - 0.120387i))

    f[6]=- 47.1636*v[6] - 1.0*ka2*(0.00112*v[2]^2 + v[2]*v[4]*(0.00215 - 0.00065i) - v[2]*v[5]*(0.00215 + 0.00065i) - v[3]*v[4]*(0.00215 - 0.00065i) - v[2]*v[6]*0.00006i + v[3]*v[5]*(0.00215 + 0.00065i) + v[2]*v[7]*0.00005i + v[3]*v[6]*0.00006i - 0.00224*v[4]*v[5] - v[3]*v[7]*0.00005i - v[4]*v[6]*(0.00002 + 0.00006i) + v[4]*v[7]*(0.00001 + 0.00005i) - v[5]*v[6]*(0.00002 - 0.00006i) + v[5]*v[7]*(0.00001 - 0.00005i) - 0.00225*v[2]*v[3] + 0.00112*v[3]^2 + v[4]^2*(0.00093 - 0.00062i) + v[5]^2*(0.00093 + 0.00062i)) - 1.0*v[4]*(- v[1]^3*(0.00000809455 - 0.00000307436i) + v[1]^2*(0.00771859 - 0.00375081i) + v[1]*(0.296768 - 0.00813346i)) - 1.0*v[5]*(- v[1]^3*(0.00000809455 + 0.00000307436i) + v[1]^2*(0.00771859 + 0.00375081i) + v[1]*(0.296768 + 0.00813346i)) + v[7]*(- v[1]^3*(0.0000970094 + 4.23489e-20i) + v[1]^2*(0.0959083 + 2.31888e-18i) + v[1]*(1.99451 + 5.6881e-17i)) - 1.0*v[2]*(- v[1]^3*(0.00000471246 + 0.00000349051i) + v[1]^2*(0.004705 + 0.0027992i) + v[1]*(0.0243829 - 0.0146621i)) - 1.0*v[3]*(- v[1]^3*(0.00000471246 - 0.00000349051i) + v[1]^2*(0.004705 - 0.0027992i) + v[1]*(0.0243829 + 0.0146621i)) - 1.0*v[6]*(v[1]^3*(0.000014836 + 6.47659e-21i) - v[1]^2*(0.0160897 + 9.75407e-19i) + v[1]*(1.96279 + 6.86328e-17i)) + ka3*(v[2]*v[3]^2*0.00018i - v[2]^2*v[3]*0.00018i + v[2]*v[4]^2*(0.0001 + 0.00015i) + v[2]^2*v[4]*(0.00005 + 0.00018i) - v[2]*v[5]^2*(0.0001 - 0.00015i) - v[3]*v[4]^2*(0.0001 + 0.00015i) + v[2]^2*v[5]*(0.00005 - 0.00018i) + v[3]^2*v[4]*(0.00005 + 0.00018i) + v[3]*v[5]^2*(0.0001 - 0.00015i) + 0.00001*v[2]^2*v[6] + v[3]^2*v[5]*(0.00005 - 0.00018i) - v[4]*v[5]^2*(0.00005 - 0.00018i) + 0.00001*v[3]^2*v[6] - v[4]^2*v[5]*(0.00005 + 0.00018i) + v[2]^3*0.00006i - v[3]^3*0.00006i + v[4]^3*(0.00005 + 0.00004i) + v[5]^3*(0.00005 - 0.00004i) - v[2]*v[3]*v[4]*(0.00011 + 0.00035i) - v[2]*v[3]*v[5]*(0.00011 - 0.00035i) - 0.00001*v[2]*v[3]*v[6] - v[2]*v[4]*v[5]*0.00037i + 0.00001*v[2]*v[3]*v[7] + 0.00001*v[2]*v[4]*v[6] + v[3]*v[4]*v[5]*0.00037i - 0.00001*v[2]*v[4]*v[7] - 0.00001*v[2]*v[5]*v[6] - 0.00001*v[3]*v[4]*v[6] + 0.00001*v[2]*v[5]*v[7] + 0.00001*v[3]*v[4]*v[7] + 0.00001*v[3]*v[5]*v[6] - 0.00001*v[3]*v[5]*v[7] - 0.00001*v[4]*v[5]*v[6] + 0.00001*v[4]*v[5]*v[7])

    f[7]=- 7.17103*v[7] + v[4]*(- v[1]^3*(0.00000200279 - 7.60675e-7i) + v[1]^2*(0.0010852 - 0.000614867i) + v[1]*(0.0374856 - 0.00440386i)) + v[5]*(- v[1]^3*(0.00000200279 + 7.60675e-7i) + v[1]^2*(0.0010852 + 0.000614867i) + v[1]*(0.0374856 + 0.00440386i)) - 1.0*v[7]*(- v[1]^3*(0.0000240026 + 1.83924e-20i) + v[1]^2*(0.0138481 - 1.01014e-18i) + v[1]*(0.290099 - 1.68169e-17i)) - 1.0*v[2]*(v[1]^3*(0.00000116598 + 8.63639e-7i) - v[1]^2*(0.000684091 + 0.000337026i) + v[1]*(0.000578732 + 0.00526632i)) - 1.0*v[3]*(v[1]^3*(0.00000116598 - 8.63639e-7i) - v[1]^2*(0.000684091 - 0.000337026i) + v[1]*(0.000578732 - 0.00526632i)) + v[6]*(v[1]^3*(0.00000367081 + 2.81283e-21i) - v[1]^2*(0.00246968 + 1.15122e-19i) + v[1]*(0.288282 - 1.04975e-17i)) - 1.0*ka3*(v[2]*v[3]^2*0.00024i - v[2]^2*v[3]*0.00024i + v[2]*v[4]^2*(0.00013 + 0.0002i) + v[2]^2*v[4]*(0.00007 + 0.00023i) - v[2]*v[5]^2*(0.00013 - 0.0002i) - v[3]*v[4]^2*(0.00013 + 0.0002i) + v[2]^2*v[5]*(0.00007 - 0.00023i) + v[3]^2*v[4]*(0.00007 + 0.00023i) + v[3]*v[5]^2*(0.00013 - 0.0002i) + 0.00001*v[2]^2*v[6] + v[3]^2*v[5]*(0.00007 - 0.00023i) - v[4]*v[5]^2*(0.00007 - 0.00022i) - 0.00001*v[2]^2*v[7] + 0.00001*v[3]^2*v[6] - v[4]^2*v[5]*(0.00007 + 0.00022i) - 0.00001*v[3]^2*v[7] + 0.00001*v[4]^2*v[6] + 0.00001*v[5]^2*v[6] + v[2]^3*0.00008i - v[3]^3*0.00008i + v[4]^3*(0.00006 + 0.00005i) + v[5]^3*(0.00006 - 0.00005i) - v[2]*v[3]*v[4]*(0.00014 + 0.00045i) - v[2]*v[3]*v[5]*(0.00014 - 0.00045i) - 0.00001*v[2]*v[3]*v[6] - v[2]*v[4]*v[5]*0.00047i + 0.00001*v[2]*v[3]*v[7] + 0.00001*v[2]*v[4]*v[6] + v[3]*v[4]*v[5]*0.00047i - 0.00001*v[2]*v[4]*v[7] - 0.00001*v[2]*v[5]*v[6] - 0.00001*v[3]*v[4]*v[6] + 0.00001*v[2]*v[5]*v[7] + 0.00001*v[3]*v[4]*v[7] + 0.00001*v[3]*v[5]*v[6] - 0.00001*v[3]*v[5]*v[7] - 0.00001*v[4]*v[5]*v[6] + 0.00001*v[4]*v[5]*v[7]) + ka2*(0.00144*v[2]^2 + v[2]*v[4]*(0.00275 - 0.00083i) - v[2]*v[5]*(0.00275 + 0.00083i) - v[3]*v[4]*(0.00275 - 0.00083i) - v[2]*v[6]*0.00008i + v[3]*v[5]*(0.00275 + 0.00083i) + v[2]*v[7]*0.00006i + v[3]*v[6]*0.00008i - 0.00287*v[4]*v[5] - v[3]*v[7]*0.00006i - v[4]*v[6]*(0.00002 + 0.00008i) + v[4]*v[7]*(0.00002 + 0.00006i) - v[5]*v[6]*(0.00002 - 0.00008i) + v[5]*v[7]*(0.00002 - 0.00006i) - 0.00288*v[2]*v[3] + 0.00144*v[3]^2 + v[4]^2*(0.0012 - 0.00079i) + v[5]^2*(0.0012 + 0.00079i))

    f[2] = f[2]/ω_h; f[3] = f[3]/ω_h; f[4] = f[4]/ω_h; f[5] = f[5]/ω_h; f[6] = f[6]/ω_h; f[7] = f[7]/ω_h;

    return calculate_normal_form(f, v, norder, cm, m1, m2, m3, n, ω_h, zero_tol)
end



end # module
